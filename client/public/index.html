<!DOCTYPE html>
<html lang="en">
  <head>

    <meta httpEquiv="Content-Type" content="text/html; charset=utf-8" />

    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <meta
      name="marysonthego portfolio"
      content="marysonthego.tech React Portfolio"
    />

    <link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Finlandica:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Red+Hat+Mono:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">

    <style> @import url('https://fonts.googleapis.com/css2?family=Finlandica:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Red+Hat+Mono:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap'); </style>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous" />

    <link rel="stylesheet" href="https://unpkg.com/xterm@4.19.0/css/xterm.css" />
  <link rel="stylesheet" href="%PUBLIC_URL%/packages/runtime//styles.css" />
  <script src="https://unpkg.com/xterm-addon-fit@0.5.0/lib/xterm-addon-fit.js"></script>
  <script src="https://unpkg.com/xterm@4.19.0/lib/xterm.js"></script>
  <script src="%PUBLIC_URL%/packages/runtime/lib/libv86.js"></script>

  <script>
    window.onload = () => {
      const baseOptions = {
        wasm_path: "%PUBLIC_URL%/packages/runtime/lib/v86.wasm",
        memory_size: 128 * 1024 * 1024,
        filesystem: {
          basefs: "%PUBLIC_URL%/packages/runtime/filesystem/filesystem.json",
          baseurl: "filesystem/",
        },
        screen_container: document.getElementById("screen_container"),
        serial_container_xtermjs: document.getElementById("terminal"),
        network_relay_url: "wss://relay.widgetry.org/",
        autostart: true,
        disable_keyboard: true,
        disable_mouse: true,
        disable_speaker: true,
        acpi: true,
      };

      const params = new URL(document.location).searchParams;
      const boot = params.get("boot") === "true";

      if (boot) {
        document.getElementById("screen_container").style = "display:block";
        document.getElementById("terminal").style = "";
      }

      const bzimageUrl = "%PUBLIC_URL%/packages/runtime/filesystem/27d6e559.bin";
      const options = {
        ...baseOptions,
        ...(boot
          ? {
              bzimage: {
                url: bzimageUrl,
              },
              cmdline: [
                "rw",
                "root=host9p rootfstype=9p rootflags=version=9p2000.L,trans=virtio,cache=loose quiet acpi=off console=ttyS0 tsc=reliable mitigations=off random.trust_cpu=on nowatchdog page_poison=on",
              ].join(" "),
              bios: {
                url: "%PUBLIC_URL%/packages/runtime/bios/seabios.bin",
              },
              vga_bios: {
                url: "%PUBLIC_URL%/packages/runtime/bios/vgabios.bin",
              },
            }
          : { initial_state: { url: "%PUBLIC_URL%/packages/runtime/state/state.zst" } }),
      };

      var emulator = new V86Starter(options);

      function initTerm() {
        const fitAddon = new FitAddon.FitAddon();
        emulator.serial_adapter.term.loadAddon(fitAddon);
        fitAddon.fit();
        window.addEventListener("resize", () => fitAddon.fit());
      }

      function sendBackgroundCommands(commands) {
        const filename = `${(Math.random() + 1).toString(36).substring(7)}.sh`;
        emulator.create_file(
          `/inbox/${filename}`,
          new TextEncoder("UTF-8").encode(commands.join("\n"))
        );
      }

      if (!boot) {
        emulator.add_listener("emulator-ready", function () {
          initTerm();
          setTimeout(() => {
            sendBackgroundCommands(["/etc/init.d/S40network restart"]);
            emulator.serial0_send(
              `\\! stty rows ${emulator.serial_adapter.term.rows} cols ${emulator.serial_adapter.term.cols} && reset\n`
            );
            emulator.serial_adapter.term.focus();
          }, 0);
        });
      }

      var state;
    };
  </script>

    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <!--
      Notice the use of %PUBLIC_URL% in the tags above.
      It will be replaced with the URL of the `public` folder during the build.
      Only files inside the `public` folder can be referenced from the HTML.
      Unlike "/favicon.ico" or "favicon.ico", "%PUBLIC_URL%/favicon.ico" will
      work correctly both with client-side routing and a non-root public URL.
      Learn how to configure a non-root public URL by running `npm run build`.
    -->
    <title>marysonthego</title>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>

    <div id="root"></div>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>

    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/gist-embed@1.0.4/dist/gist-embed.min.js">
    </script>

    <script src="https://platform.linkedin.com/badges/js/profile.js" async defer type="text/javascript"></script>

    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

  </body>
</html>
